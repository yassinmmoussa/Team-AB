"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

<<<<<<< HEAD
function errorMessage(schema, data, message) {
=======
/** @typedef {import("ajv").Ajv} Ajv */

/** @typedef {import("../validate").SchemaUtilErrorObject} SchemaUtilErrorObject */

/**
 *
 * @param {string} data
 * @param {object} schema
 * @param {string} message
 * @returns {object} // Todo `returns` should be `SchemaUtilErrorObject`
 */
function errorMessage(message, schema, data) {
>>>>>>> 0ae1a948acc774b725d2813ed0b826c52e048967
  return {
    keyword: 'absolutePath',
    params: {
      absolutePath: data
    },
    message,
    parentSchema: schema
  };
}
<<<<<<< HEAD

function getErrorFor(shouldBeAbsolute, data, schema) {
  const message = shouldBeAbsolute ? `The provided value ${JSON.stringify(data)} is not an absolute path!` : `A relative path is expected. However, the provided value ${JSON.stringify(data)} is an absolute path!`;
  return errorMessage(schema, data, message);
}

var _default = ajv => ajv.addKeyword('absolutePath', {
  errors: true,
  type: 'string',

  compile(expected, schema) {
    function callback(data) {
      let passes = true;
      const isExclamationMarkPresent = data.includes('!');
      const isCorrectAbsoluteOrRelativePath = expected === /^(?:[A-Za-z]:\\|\/)/.test(data);

      if (isExclamationMarkPresent) {
        callback.errors = [errorMessage(schema, data, `The provided value ${JSON.stringify(data)} contains exclamation mark (!) which is not allowed because it's reserved for loader syntax.`)];
        passes = false;
      }

      if (!isCorrectAbsoluteOrRelativePath) {
        callback.errors = [getErrorFor(expected, data, schema)];
        passes = false;
      }

      return passes;
    }

    callback.errors = [];
    return callback;
  }

});

=======
/**
 * @param {boolean} shouldBeAbsolute
 * @param {object} schema
 * @param {string} data
 * @returns {object}
 */


function getErrorFor(shouldBeAbsolute, schema, data) {
  const message = shouldBeAbsolute ? `The provided value ${JSON.stringify(data)} is not an absolute path!` : `A relative path is expected. However, the provided value ${JSON.stringify(data)} is an absolute path!`;
  return errorMessage(message, schema, data);
}
/**
 *
 * @param {Ajv} ajv
 * @returns {Ajv}
 */


function addAbsolutePathKeyword(ajv) {
  ajv.addKeyword('absolutePath', {
    errors: true,
    type: 'string',

    compile(schema, parentSchema) {
      /**
       * @param {any} data
       * @returns {boolean}
       */
      function callback(data) {
        let passes = true;
        const isExclamationMarkPresent = data.includes('!');
        const isCorrectAbsoluteOrRelativePath = schema === /^(?:[A-Za-z]:\\|\/)/.test(data);

        if (isExclamationMarkPresent) {
          callback.errors = [errorMessage(`The provided value ${JSON.stringify(data)} contains exclamation mark (!) which is not allowed because it's reserved for loader syntax.`, parentSchema, data)];
          passes = false;
        }

        if (!isCorrectAbsoluteOrRelativePath) {
          callback.errors = [getErrorFor(schema, parentSchema, data)];
          passes = false;
        }

        return passes;
      }
      /** @type {null | Array<SchemaUtilErrorObject>}*/


      callback.errors = [];
      return callback;
    }

  });
  return ajv;
}

var _default = addAbsolutePathKeyword;
>>>>>>> 0ae1a948acc774b725d2813ed0b826c52e048967
exports.default = _default;